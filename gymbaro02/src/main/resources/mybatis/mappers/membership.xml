<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="mapper.membership">
	<resultMap id="membershipResult" type="membershipVO">
	</resultMap>
	
<insert id="insertNewMembership" parameterType="java.util.Map">
	<![CDATA[
	insert into membership(membership_id, uid, name, gender, birth, phone_number, zipcode, roadAddress,
	extraAddress, gym_id, gym_name, first_option, second_option, start_date, last_date, payment, 
	total_price, membership_state) values(#{membership_id}, #{uid}, #{name}, #{gender}, #{birth}, 
	#{phone_number}, #{zipcode}, #{roadAddress}, #{extraAddress}, #{gym_id}, #{gym_name}, 
	#{first_option}, #{option}, #{start_date}, #{last_date}, #{payment}, #{total_price},
	#{membership_state})
	]]>
</insert>

<select id="selectMembershipID" resultType="String">
	    <![CDATA[select concat(replace(curdate(), '-', ''),(case count(*) when 0 then 1 else max(cast(substring(membership_id,9) as signed)) + 1  end)) from membership]]>
 </select>
</mapper>